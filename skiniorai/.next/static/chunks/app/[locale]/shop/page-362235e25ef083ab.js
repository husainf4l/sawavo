(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[158],{230:(e,r,s)=>{Promise.resolve().then(s.bind(s,6160)),Promise.resolve().then(s.bind(s,1473))},1473:(e,r,s)=>{"use strict";s.d(r,{default:()=>c});var a=s(5155),t=s(7652),l=s(2115),i=s(1737),o=s(4295);function c(e){let{locale:r}=e,s=(0,t.c3)(),[c,n]=(0,l.useState)([]),[d,u]=(0,l.useState)(!0),[h,g]=(0,l.useState)(null),[m,p]=(0,l.useState)(""),[x,b]=(0,l.useState)("all"),[v,y]=(0,l.useState)("relevance"),[w,j]=(0,l.useState)(1),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=!0;return u(!0),g(null),i.W.getProducts().then(r=>{e&&n(r||[])}).catch(r=>{e&&g(s("shop.loadingError")||"Failed to load products")}).finally(()=>{e&&u(!1)}),()=>{e=!1,f.current&&window.clearTimeout(f.current)}},[s]);let N=(0,l.useMemo)(()=>{let e=new Map;return c.forEach(r=>{var s,a,t;let l=(null==(s=r.category)?void 0:s.name)||(null==(a=r.category)?void 0:a.slug)||"uncategorized",i=(null==(t=r.category)?void 0:t.id)||l;e.has(String(i))||e.set(String(i),String(l))}),[{id:"all",name:s("shop.allCategories")??"All"},...Array.from(e.entries()).map(e=>{let[r,s]=e;return{id:r,name:s}})]},[c,s]),C=(0,l.useCallback)(e=>{f.current&&window.clearTimeout(f.current),f.current=window.setTimeout(()=>{p(e),j(1)},300)},[]),S=(0,l.useMemo)(()=>{let e=c.slice();if(m.trim()){let r=m.trim().toLowerCase();e=e.filter(e=>{var s,a,t,l,i,o;return(null==(s=e.title)?void 0:s.toLowerCase().includes(r))||(null==(a=e.titleAr)?void 0:a.toLowerCase().includes(r))||(null==(t=e.sku)?void 0:t.toLowerCase().includes(r))||(null==(l=e.activeIngredients)?void 0:l.toLowerCase().includes(r))||(null==(i=e.descriptionEn)?void 0:i.toLowerCase().includes(r))||(null==(o=e.descriptionAr)?void 0:o.toLowerCase().includes(r))})}switch(x&&"all"!==x&&(e=e.filter(e=>{var r;return String(e.categoryId)===String(x)||String(null==(r=e.category)?void 0:r.id)===String(x)})),v){case"price_asc":e.sort((e,r)=>e.price-r.price);break;case"price_desc":e.sort((e,r)=>r.price-e.price);break;case"newest":e.sort((e,r)=>new Date(r.createdAt).getTime()-new Date(e.createdAt).getTime())}return e},[c,m,x,v]),k=Math.max(1,Math.ceil(S.length/12));(0,l.useEffect)(()=>{w>k&&j(k)},[w,k]);let L=(0,l.useMemo)(()=>{let e=(w-1)*12;return S.slice(e,e+12)},[S,w]);return d?(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("div",{className:"w-2/3",children:(0,a.jsx)("div",{className:"h-10 bg-gray-200 rounded-md animate-pulse"})}),(0,a.jsxs)("div",{className:"w-1/3 flex gap-3 justify-end",children:[(0,a.jsx)("div",{className:"h-10 w-28 bg-gray-200 rounded-md animate-pulse"}),(0,a.jsx)("div",{className:"h-10 w-28 bg-gray-200 rounded-md animate-pulse"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((e,r)=>(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-4 animate-pulse h-64"},r))})]}):h?(0,a.jsx)("div",{className:"mt-8 text-center text-red-500",children:h}):(0,a.jsxs)("section",{className:`${"ar"===r?"rtl font-cairo":"ltr"}`,"aria-labelledby":"shop-heading",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{htmlFor:"search",className:"sr-only",children:s("shop.search")||"Search"}),(0,a.jsx)("input",{id:"search",type:"search",placeholder:s("shop.searchPlaceholder")||"Search products, ingredients or SKU...",onChange:e=>C(e.target.value),className:"w-full border border-gray-200 rounded-lg px-4 py-2 focus:ring-2 focus:ring-black/10 focus:border-black/20","aria-label":s("shop.search")||"Search"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("label",{htmlFor:"category",className:"sr-only",children:s("shop.category")||"Category"}),(0,a.jsx)("select",{id:"category",value:x,onChange:e=>{b(e.target.value),j(1)},className:"border border-gray-200 rounded-lg px-3 py-2 bg-white","aria-label":s("shop.category")||"Category",children:N.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,a.jsx)("label",{htmlFor:"sort",className:"sr-only",children:s("shop.sort")||"Sort"}),(0,a.jsxs)("select",{id:"sort",value:v,onChange:e=>{y(e.target.value),j(1)},className:"border border-gray-200 rounded-lg px-3 py-2 bg-white","aria-label":s("shop.sort")||"Sort",children:[(0,a.jsx)("option",{value:"relevance",children:s("shop.sortRelevance")||"Relevance"}),(0,a.jsx)("option",{value:"price_asc",children:s("shop.sortPriceLow")||"Price: Low to High"}),(0,a.jsx)("option",{value:"price_desc",children:s("shop.sortPriceHigh")||"Price: High to Low"}),(0,a.jsx)("option",{value:"newest",children:s("shop.sortNewest")||"Newest"})]})]})]}),(0,a.jsx)("div",{className:"mb-4 text-sm text-gray-600",children:s("shop.resultsCount",{count:S.length})??`${S.length} products found`}),0===L.length?(0,a.jsx)("div",{className:"mt-8 text-center text-gray-500",children:s("shop.noResults")||"No products match your search."}):(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:L.map(e=>(0,a.jsx)(o.A,{product:e},e.id))}),k>1&&(0,a.jsxs)("nav",{"aria-label":"Pagination",className:"mt-8 flex justify-center items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>j(e=>Math.max(1,e-1)),disabled:1===w,className:"px-3 py-2 rounded-md border border-gray-200 bg-white disabled:opacity-50","aria-label":s("shop.prev")||"Previous",children:"‹"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:k}).map((e,r)=>{let s=r+1;return(0,a.jsx)("button",{onClick:()=>j(s),"aria-current":w===s?"page":void 0,className:`px-3 py-2 rounded-md border ${w===s?"bg-black text-white":"bg-white"} border-gray-200`,children:s},s)})}),(0,a.jsx)("button",{onClick:()=>j(e=>Math.min(k,e+1)),disabled:w===k,className:"px-3 py-2 rounded-md border border-gray-200 bg-white disabled:opacity-50","aria-label":s("shop.next")||"Next",children:"›"})]})]})}}},e=>{e.O(0,[119,874,766,132,619,441,964,977],()=>e(e.s=230)),_N_E=e.O()}]);